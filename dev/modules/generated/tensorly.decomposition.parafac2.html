


<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <meta name="keywords" content="tensor learning, tensor decomposition, tensor operations">
        <meta name="description" content="TensorLy: Tensor learning in Python">

        
        <meta name="author" content="Jean Kossaifi">
        <title>TensorLy: Tensor learning in Python</title>
        

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="../../_static/bulma.min.css" />
        <link rel="stylesheet" type="text/css" href="../../_static/base.min.css" />
        <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

        
        

        
        
    </head>

    <body>
        
        <nav class="navbar is-dark has-shadow top" id="top">
    <div class="navbar-brand">
        <a class="navbar-item navbar-title" href="../../index.html">
            TensorLy
        </a>

        <a class="navbar-item is-tab is-hidden-desktop" href="../../index.html">
            <i class="fa fa-home" aria-hidden="true"></i>
        </a>

        <a class="navbar-item is-tab is-hidden-desktop" href="https://github.com/tensorly/tensorly" target="_blank">
            <span class="icon"><i class="fa fa-github"></i></span>
        </a>

		<span class="navbar-burger" data-target="NavbarMenu" >
			<span></span>
			<span></span>
			<span></span>
		</span>
    </div>

	<div id="NavbarMenu" class="navbar-menu">
		<div class="navbar-start">

			<a class="navbar-item" href="../../installation.html">
				Install
			</a>
			<a class="navbar-item" href="../../user_guide/index.html">
				User Guide
			</a>
			<a class="navbar-item" href="../api.html">
				API
			</a>
			<a class="navbar-item" href="../../auto_examples/index.html">
				Examples
			</a>
			<a class="navbar-item" href="../../about.html">
				About Us
			</a>
			<a class="navbar-item" href="https://github.com/JeanKossaifi/tensorly-notebooks" target="_blank">
				Notebooks
			</a>

		</div>

		<div class="navbar-end">
			<a class="navbar-item is-tab tooltip is-hidden-touch" href="../../index.html">
				<i class="fa fa-home" aria-hidden="true"></i>
				<span class="tooltiptext">Home page</span>
			</a>

			<a class="navbar-item is-tab tooltip is-hidden-touch" href="https://github.com/tensorly/tensorly" target="_blank">
				<span class="tooltiptext">Open project on Github</span>
				<span class="icon"><i class="fa fa-github"></i></span>
			</a>

		</div>
    </div>
</nav>
 

        
        <div class="columns">

                
            <div class="column is-one-quarter is-hidden-mobile aside">
    <div class="sidebar" id="sidebar">
        
        <div class="search">
            <div class="search-title">
                Search in TensorLy
            </div>

            <script>
              (function() {
                var cx = '002285679029256671182:5tfqz3cvmm8';
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
              })();
            </script>
            <gcse:searchbox-only></gcse:searchbox-only>
            
        </div>

        <div class="toc">
        
        
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installing tensorly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">User guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#tensorly-manipulating-the-backend-with-a-unified-interface"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly</span></code>: Manipulating the backend with a unified interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.base"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.base</span></code>: Core tensor functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.cp_tensor"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.cp_tensor</span></code>: Tensors in the CP format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.tucker_tensor"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.tucker_tensor</span></code>: Tensors in Tucker format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.tt_tensor"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.tt_tensor</span></code>: Tensors in Matrix-Product-State format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.parafac2_tensor"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.parafac2_tensor</span></code>: Tensors in PARAFAC2 format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.tenalg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.tenalg</span></code>: Tensor algebra</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#module-tensorly.decomposition"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.decomposition</span></code>: Tensor Decomposition</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../api.html#classes">Classes</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../api.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.regression"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.regression</span></code>: Tensor Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.metrics"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.metrics</span></code>: Performance measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.random"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.random</span></code>: Sampling random tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.datasets"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.datasets</span></code>: Creating and loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tensorly.contrib"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.contrib</span></code>: Experimental features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Gallery of examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_guide/index.html">Development guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/JeanKossaifi/tensorly-notebooks">Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About us</a></li>
</ul>

        
        
        </div>
        
    </div>
</div>

                
                <div class="column is-three-quarters main-column">
            


            
                <div class="content main-content">

                    

  <div class="section" id="tensorly-decomposition-parafac2">
<h1><a class="reference internal" href="../api.html#module-tensorly.decomposition" title="tensorly.decomposition"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tensorly.decomposition</span></code></a>.parafac2</h1>
<dl class="py function">
<dt id="tensorly.decomposition.parafac2">
<code class="descname">parafac2</code><span class="sig-paren">(</span><em><span class="n">tensor_slices</span></em>, <em><span class="n">rank</span></em>, <em><span class="n">n_iter_max</span><span class="o">=</span><span class="default_value">100</span></em>, <em><span class="n">init</span><span class="o">=</span><span class="default_value">'random'</span></em>, <em><span class="n">svd</span><span class="o">=</span><span class="default_value">'numpy_svd'</span></em>, <em><span class="n">normalize_factors</span><span class="o">=</span><span class="default_value">False</span></em>, <em><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-08</span></em>, <em><span class="n">random_state</span><span class="o">=</span><span class="default_value">None</span></em>, <em><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em><span class="n">return_errors</span><span class="o">=</span><span class="default_value">False</span></em>, <em><span class="n">n_iter_parafac</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/tensorly/decomposition/parafac2.html#parafac2"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>PARAFAC2 decomposition <a class="reference internal" href="#ra07d22ce3f71-1" id="id1">[1]</a> of a third order tensor via alternating least squares (ALS)</p>
<p>Computes a rank-<cite>rank</cite> PARAFAC2 decomposition of the third-order tensor defined by 
<cite>tensor_slices</cite>. The decomposition is on the form <img class="math" src="../../_images/math/7e5cefcc72773fad54dbd09a90444798f81da3c8.png" alt="(A [B_i] C)"/> such that the</p>
<blockquote>
<div>i-th frontal slice, <img class="math" src="../../_images/math/a00916b6facf7546d87368388137f7f7d6d3d7a7.png" alt="X_i"/>, of <img class="math" src="../../_images/math/1663226d2e9832c673e82eebeaf76b8f16126137.png" alt="X"/> is given by</div></blockquote>
<div class="math">
<p><img src="../../_images/math/e3fa2dac9eceee9d62f1257b8cf7d3938b4e5a72.png" alt="X_i = B_i diag(a_i) C^T,"/></p>
</div><p>where <img class="math" src="../../_images/math/92fe9d704c81c8a6234d13f01c702aac029a4215.png" alt="diag(a_i)"/> is the diagonal matrix whose nonzero entries are equal to
the <img class="math" src="../../_images/math/1557c511dfa862b05c028b69fcb98c528b00d669.png" alt="i"/>-th row of the <img class="math" src="../../_images/math/49123964effe20fb6ef3ee1778a5e52b9dbb6d73.png" alt="I \times R"/> factor matrix <img class="math" src="../../_images/math/7974c030c23054b4b0eb90654de4c5cb26511cbc.png" alt="A"/>, <img class="math" src="../../_images/math/025b4d87ac771d5d2fe0ab163b36ab8b7b483d82.png" alt="B_i"/> 
is a <img class="math" src="../../_images/math/3c1670a65c8af230b8412e85bd659415a4aba0e7.png" alt="J_i \times R"/> factor matrix such that the cross product matrix <img class="math" src="../../_images/math/4ae42f9c31c712658b4e3e58178c7fa9ab775b46.png" alt="B_{i_1}^T B_{i_1}"/>
is constant for all <img class="math" src="../../_images/math/1557c511dfa862b05c028b69fcb98c528b00d669.png" alt="i"/>, and <img class="math" src="../../_images/math/4199d51961528aac1c0778fb2c9a31eaa353ce8b.png" alt="C"/> is a <img class="math" src="../../_images/math/c5461f9eb416012b3cd303ca8f9ce3b5f579d18c.png" alt="K \times R"/> factor matrix. 
To compute this decomposition, we reformulate the expression for <img class="math" src="../../_images/math/025b4d87ac771d5d2fe0ab163b36ab8b7b483d82.png" alt="B_i"/> such that</p>
<div class="math">
<p><img src="../../_images/math/6cfaabfb8703e60da701d0ba006ced08646859c3.png" alt="B_i = P_i B,"/></p>
</div><p>where <img class="math" src="../../_images/math/868ceb20ee3d239510dee53d5eebef54de90a282.png" alt="P_i"/> is a <img class="math" src="../../_images/math/3c1670a65c8af230b8412e85bd659415a4aba0e7.png" alt="J_i \times R"/> orthogonal matrix and <img class="math" src="../../_images/math/489503f65655ae1ba33e89121fa4ba2a0d3549a3.png" alt="B"/> is a
<img class="math" src="../../_images/math/1060b27e042e5e7224ea357bd9cad0b44248b14f.png" alt="R \times R"/> matrix.</p>
<p>An alternative formulation of the PARAFAC2 decomposition is that the tensor element
<img class="math" src="../../_images/math/daba7f592f7cc008341ddc8fe1ddafde2d13b91f.png" alt="X_{ijk}"/> is given by</p>
<div class="math">
<p><img src="../../_images/math/50500affe5d25ca727daaec3c2a317dc7b57176e.png" alt="X_{ijk}&nbsp;= \sum_{r=1}^R A_{ir} B_{ijr} C_{kr},"/></p>
</div><p>with the same constraints hold for <img class="math" src="../../_images/math/025b4d87ac771d5d2fe0ab163b36ab8b7b483d82.png" alt="B_i"/> as above.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>tensor_slices</strong><span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>Either a third order tensor or a list of second order tensors that may have different number of rows.
Note that the second mode factor matrices are allowed to change over the first mode, not the
third mode as some other implementations use (see note below).</p>
</dd>
<dt><strong>rank</strong><span class="classifier">int</span></dt><dd><p>Number of components.</p>
</dd>
<dt><strong>n_iter_max</strong><span class="classifier">int</span></dt><dd><p>Maximum number of iteration</p>
</dd>
<dt><strong>init</strong><span class="classifier">{‘svd’, ‘random’, CPTensor, Parafac2Tensor}</span></dt><dd><p>Type of factor matrix initialization. See <cite>initialize_factors</cite>.</p>
</dd>
<dt><strong>svd</strong><span class="classifier">str, default is ‘numpy_svd’</span></dt><dd><p>function to use to compute the SVD, acceptable values in tensorly.SVD_FUNS</p>
</dd>
<dt><strong>normalize_factors</strong><span class="classifier">bool (optional)</span></dt><dd><p>If True, aggregate the weights of each factor in a 1D-tensor
of shape (rank, ), which will contain the norms of the factors. Note that
there may be some inaccuracies in the component weights.</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float, optional</span></dt><dd><p>(Default: 1e-8) Relative reconstruction error tolerance. The
algorithm is considered to have found the global minimum when the
reconstruction error is less than <cite>tol</cite>.</p>
</dd>
<dt><strong>random_state</strong><span class="classifier">{None, int, np.random.RandomState}</span></dt><dd></dd>
<dt><strong>verbose</strong><span class="classifier">int, optional</span></dt><dd><p>Level of verbosity</p>
</dd>
<dt><strong>return_errors</strong><span class="classifier">bool, optional</span></dt><dd><p>Activate return of iteration errors</p>
</dd>
<dt><strong>n_iter_parafac: int, optional</strong></dt><dd><p>Number of PARAFAC iterations to perform for each PARAFAC2 iteration</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Parafac2Tensor</strong><span class="classifier">(weight, factors, projection_matrices)</span></dt><dd><ul>
<li><dl class="first docutils">
<dt>weights<span class="classifier">1D array of shape (rank, )</span></dt><dd><p>all ones if normalize_factors is False (default), 
weights of the (normalized) factors otherwise</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>factors<span class="classifier">List of factors of the CP decomposition element <cite>i</cite> is of shape</span></dt><dd><p>(tensor.shape[i], rank)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>projection_matrices<span class="classifier">List of projection matrices used to create evolving</span></dt><dd><p>factors.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt><strong>errors</strong><span class="classifier">list</span></dt><dd><p>A list of reconstruction errors at each iteration of the algorithms.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This formulation of the PARAFAC2 decomposition is slightly different from the one in <a class="reference internal" href="#ra07d22ce3f71-1" id="id2">[1]</a>.
The difference lies in that here, the second mode changes over the first mode, whereas in
<a class="reference internal" href="#ra07d22ce3f71-1" id="id3">[1]</a>, the second mode changes over the third mode. We made this change since that means
that the function accept both lists of matrices and a single nd-array as input without
any reordering of the modes.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="ra07d22ce3f71-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id3">3</a>)</em> Kiers, H.A.L., ten Berge, J.M.F. and Bro, R. (1999), 
PARAFAC2—Part I. A direct fitting algorithm for the PARAFAC2 model. 
J. Chemometrics, 13: 275-294.</td></tr>
</tbody>
</table>
</dd></dl>

<div class="clearer"></div></div>




                    <nav class="pagination">
    
    
    <a class="button is-medium pagination-previous" href="tensorly.decomposition.tensor_train.html" title="tensorly.decomposition.tensor_train" accesskey="p">
        <span class="icon">
            <i class="fa fa-arrow-circle-left"></i>
        </span>
        <span>Previous</span>
    </a>
    
    
    <a class="button is-medium pagination-next" href="tensorly.decomposition.symmetric_power_iteration.html" title="tensorly.decomposition.symmetric_power_iteration" accesskey="n">
        <span>Next </span>
        <span class="icon">
            <i class="fa fa-arrow-circle-right"></i>
        </span>
    </a>
    
</nav>

                </div>

                <footer class="footer">
    <div class="container has-text-centered">

        <p>
                &copy; 2016 - 2020, TensorLy Developers.
        </p> 
    </div>
</footer>
            </div>

        </div>

        
        

        <script src="../../_static/navigation.min.js"></script>
        <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-86209849-1', 'auto');
    ga('send', 'pageview');
</script>

    </body>
</html>