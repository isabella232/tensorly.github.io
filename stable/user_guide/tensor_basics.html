


<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <meta name="keywords" content="tensor learning, tensor decomposition, tensor operations">
        <meta name="description" content="TensorLy: Tensor learning in Python">

        
        <meta name="author" content="Jean Kossaifi">
        <title>TensorLy: Tensor learning in Python</title>
        

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="../_static/bulma.min.css" />
        <link rel="stylesheet" type="text/css" href="../_static/base.min.css" />
        <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

        
        

        
        
    </head>

    <body>
        
        <nav class="navbar is-dark has-shadow top" id="top">
    <div class="navbar-brand">
        <a class="navbar-item navbar-title" href="../home.html">
            TensorLy
        </a>

        <a class="navbar-item is-tab is-hidden-desktop" href="../index.html">
            <i class="fa fa-home" aria-hidden="true"></i>
        </a>

        <a class="navbar-item is-tab is-hidden-desktop" href="https://github.com/tensorly/tensorly" target="_blank">
            <span class="icon"><i class="fa fa-github"></i></span>
        </a>

		<span class="navbar-burger" data-target="NavbarMenu" >
			<span></span>
			<span></span>
			<span></span>
		</span>

    </div>

	<div id="NavbarMenu" class="navbar-menu">
		<div class="navbar-start">

			<a class="navbar-item" href="../installation.html">
				Install
			</a>
			<a class="navbar-item" href="index.html">
				User guide
			</a>
			<a class="navbar-item" href="../modules/api.html">
				API
			</a>
			<a class="navbar-item" href="../auto_examples/index.html">
				Examples
			</a>
			<a class="navbar-item" href="../about.html">
				About us
			</a>
			<a class="navbar-item" href="https://github.com/JeanKossaifi/tensorly-notebooks" target="_blank">
				Notebooks
			</a>

		</div>

		<div class="navbar-end">
			<a class="navbar-item is-tab tooltip is-hidden-touch" href="../index.html">
				<i class="fa fa-home" aria-hidden="true"></i>
				<span class="tooltiptext">Home page</span>
			</a>

			<a class="navbar-item is-tab tooltip is-hidden-touch" href="https://github.com/tensorly/tensorly" target="_blank">
				<span class="tooltiptext">Open project on Github</span>
				<span class="icon"><i class="fa fa-github"></i></span>
			</a>

		</div>
    </div>
</nav>
 

        
        <div class="columns">
            
            <div class="column is-one-quarter is-hidden-mobile aside">
                <div class="sidebar" id="sidebar">
                    
                    <div class="search">
                        <div class="search-title">
                            Search in TensorLy
                        </div>

                        <script>
                          (function() {
                            var cx = '002285679029256671182:5tfqz3cvmm8';
                            var gcse = document.createElement('script');
                            gcse.type = 'text/javascript';
                            gcse.async = true;
                            gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                            var s = document.getElementsByTagName('script')[0];
                            s.parentNode.insertBefore(gcse, s);
                          })();
                        </script>
                        <gcse:searchbox-only></gcse:searchbox-only>
                        
                    </div>

                    <div class="toc">
                    
                    
                    
                    
                        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing tensorly</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">1. Quick-Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="backend.html">2. TensorLy’s backend system</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3. Tensor basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-tensor">3.1. Creating a tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unfolding">3.2. Unfolding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#folding">3.3. Folding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#references">3.4. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tensor_decomposition.html">4. Tensor decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="tensor_regression.html">5. Tensor regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_backend.html">6. Sparse Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_backend.html#usage">7. Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_backend.html#example">8. Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Gallery of examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development_guide/index.html">Development guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/JeanKossaifi/tensorly-notebooks">Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About us</a></li>
</ul>

                    
                    
                    </div>
                    
                </div>
            </div>

            
            <div class="column is-three-quarters main-column">
                <div class="content main-content">

                    

  <div class="section" id="tensor-basics">
<h1><span class="section-number">3. </span>Tensor basics</h1>
<div class="section" id="creating-a-tensor">
<h2><span class="section-number">3.1. </span>Creating a tensor</h2>
<p>A tensor is nothing more than a multi-dimensional array.</p>
<p>Let’s take for this example the tensor <img class="math" src="../_images/math/a1eabf830df63fb216b837b83531d7a03a97aeed.png" alt="\tilde X"/> defined by its frontal slices:</p>
<div class="math">
<p><img src="../_images/math/c587deb32528316a187ccca68b85d61201194538.png" alt="X_1 =
\left[
\begin{matrix}
0  &amp; 2  &amp; 4  &amp; 6\\
8  &amp; 10 &amp; 12 &amp; 14\\
16 &amp; 18 &amp; 20 &amp; 22\\
\end{matrix}
\right]

\text{and}

X_2 =
\left[
\begin{matrix}
1  &amp; 3  &amp; 5  &amp; 7\\
9  &amp; 11 &amp; 13 &amp; 15\\
17 &amp; 19 &amp; 21 &amp; 23\\
\end{matrix}
\right]"/></p>
</div><p>In Python, this array can be expressed as a numpy array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tensorly</span> <span class="k">as</span> <span class="nn">tl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
<p>You can view the frontal slices by fixing the last axis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">array([[ 0,  2,  4,  6],</span>
<span class="go">       [ 8, 10, 12, 14],</span>
<span class="go">       [16, 18, 20, 22]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">array([[ 1,  3,  5,  7],</span>
<span class="go">       [ 9, 11, 13, 15],</span>
<span class="go">       [17, 19, 21, 23]])</span>
</pre></div>
</div>
</div>
<div class="section" id="unfolding">
<h2><span class="section-number">3.2. </span>Unfolding</h2>
<p>Also called <strong>matrization</strong>, <strong>unfolding</strong> a tensor is done by reading the element in a given way as to obtain a matrix instead of a tensor.</p>
<p>For a tensor of size <img class="math" src="../_images/math/267d50f457b0de0e577cc9fcb19eab6528b8c899.png" alt="(I_0, I_1, \cdots, I_N)"/>, the n-mode unfolding of this tensor will be of size <img class="math" src="../_images/math/56be6f5cfc02befc55ca906d00ce27571fc05e2d.png" alt="(I_n, I_0, I_1 \times \cdots \times I_{n-1} \times I_{n+1} \cdots \times I_N)"/>.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>In tensorly we use an unfolding different from the classical one as defined in <a class="footnote-reference" href="#id2" id="id1">[1]</a> for better performance.</p>
<p>Given a tensor <img class="math" src="../_images/math/d58f41145b94a6e17dc8672ac824b056a06cf5ee.png" alt="\tilde X \in \mathbb{R}^{I_0, I_1 \times I_2 \times \cdots \times I_N}"/>, the
mode-n unfolding of <img class="math" src="../_images/math/a1eabf830df63fb216b837b83531d7a03a97aeed.png" alt="\tilde X"/> is a matrix <img class="math" src="../_images/math/38c1e934184582677d3addf0297a1f91c8094fe9.png" alt="\mathbf{X}_{[n]} \in \mathbb{R}^{I_n, I_M}"/>,
with <img class="math" src="../_images/math/0c9a0b6cbe6dd3838dfec03819156d38a2a79869.png" alt="M = \prod_{\substack{k=0,\\k \neq n}}^N I_k"/> and is defined by
the mapping from element <img class="math" src="../_images/math/ddc5a930d6d9dda09f065bea14fa9e4b457f6d90.png" alt="(i_0, i_1, \cdots, i_N)"/> to <img class="math" src="../_images/math/1b782627d1b0843af085aa264886d73f35e56715.png" alt="(i_n, j)"/>, with</p>
<div class="last math">
<p><img src="../_images/math/ba6269823af0bd7948da27251523a178013303d4.png" alt="j = \sum_{\substack{k=0,\\k \neq n}}^N i_k \times \prod_{\substack{m=k+1,\\ k \neq n}}^N I_m."/></p>
</div></div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Traditionally, mode-1 unfolding denotes the unfolding along the first dimension.
However, to be consistent with the Python indexing that always starts at zero,
in tensorly, unfolding also starts at zero!</p>
<p class="last">Therefore <code class="docutils literal notranslate"><span class="pre">unfold(tensor,</span> <span class="pre">0)</span></code> will unfold said tensor along its first dimension!</p>
</div>
<p>For instance, using the <img class="math" src="../_images/math/a1eabf830df63fb216b837b83531d7a03a97aeed.png" alt="\tilde X"/> previously defined, the 0-mode unfolding of <img class="math" src="../_images/math/a1eabf830df63fb216b837b83531d7a03a97aeed.png" alt="\tilde X"/>:</p>
<div class="math">
<p><img src="../_images/math/c74d0d9c47ab6402433fc35cf8b844603b0b30c7.png" alt="\tilde X_{[0]} =
\left[ \begin{matrix}
   0  &amp; 1  &amp; 2  &amp; 3  &amp;  4 &amp; 5  &amp; 6  &amp; 7\\
   8  &amp; 9  &amp; 10 &amp; 11 &amp; 12 &amp; 13 &amp; 14 &amp; 15\\
   16 &amp; 17 &amp; 18 &amp; 19 &amp; 20 &amp; 21 &amp; 22 &amp; 23\\
\end{matrix} \right]"/></p>
</div><p>The 1-mode unfolding is given by:</p>
<div class="math">
<p><img src="../_images/math/381707c122ba91ae60ca1d8e0ae0d14ff52c218a.png" alt="\tilde X_{[1]} =
\left[ \begin{matrix}
   0 &amp; 1 &amp; 8  &amp; 9  &amp; 16 &amp; 17\\
   2 &amp; 3 &amp; 10 &amp; 11 &amp; 18 &amp; 19\\
   4 &amp; 5 &amp; 12 &amp; 13 &amp; 20 &amp; 21\\
   6 &amp; 7 &amp; 14 &amp; 15 &amp; 22 &amp; 23\\
\end{matrix} \right]"/></p>
</div><p>Finally, the 2-mode unfolding is the unfolding along the last axis:</p>
<div class="math">
<p><img src="../_images/math/db8764a521e3ebc1c0e0543de415b7c513d40aca.png" alt="\tilde X_{[2]} =
\left[ \begin{matrix}
   0 &amp; 2 &amp; 4 &amp; 6 &amp; 8 &amp; 10 &amp; 12 &amp; 14 &amp; 16 &amp; 18 &amp; 20 &amp; 22\\
   1 &amp; 3 &amp; 5 &amp; 7 &amp; 9 &amp; 11 &amp; 13 &amp; 15 &amp; 17 &amp; 19 &amp; 21 &amp; 23\\
\end{matrix} \right]"/></p>
</div><p>In tensorly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensorly</span> <span class="kn">import</span> <span class="n">unfold</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unfold</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># mode-1 unfolding</span>
<span class="go">array([[ 0,  1,  2,  3,  4,  5,  6,  7],</span>
<span class="go">       [ 8,  9, 10, 11, 12, 13, 14, 15],</span>
<span class="go">       [16, 17, 18, 19, 20, 21, 22, 23]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">unfold</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># mode-2 unfolding</span>
<span class="go">array([[ 0,  1,  8,  9, 16, 17],</span>
<span class="go">       [ 2,  3, 10, 11, 18, 19],</span>
<span class="go">       [ 4,  5, 12, 13, 20, 21],</span>
<span class="go">       [ 6,  7, 14, 15, 22, 23]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">unfold</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># mode-3 unfolding</span>
<span class="go">array([[ 0,  2,  4,  6,  8, 10, 12, 14, 16, 18, 20, 22],</span>
<span class="go">       [ 1,  3,  5,  7,  9, 11, 13, 15, 17, 19, 21, 23]])</span>
</pre></div>
</div>
</div>
<div class="section" id="folding">
<h2><span class="section-number">3.3. </span>Folding</h2>
<p>You can <strong>fold</strong> an unfolded tensor back from matrix to full tensor using the <a class="reference internal" href="../modules/generated/tensorly.base.fold.html#tensorly.base.fold" title="tensorly.base.fold"><code class="xref py py-func docutils literal notranslate"><span class="pre">tensorly.base.fold</span></code></a> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensorly</span> <span class="kn">import</span> <span class="n">fold</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unfolding</span> <span class="o">=</span> <span class="n">unfold</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original_shape</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fold</span><span class="p">(</span><span class="n">unfolding</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">original_shape</span><span class="p">)</span>
<span class="go">array([[[ 0,  1],</span>
<span class="go">     [ 2,  3],</span>
<span class="go">     [ 4,  5],</span>
<span class="go">     [ 6,  7]],</span>

<span class="go">    [[ 8,  9],</span>
<span class="go">     [10, 11],</span>
<span class="go">     [12, 13],</span>
<span class="go">     [14, 15]],</span>

<span class="go">    [[16, 17],</span>
<span class="go">     [18, 19],</span>
<span class="go">     [20, 21],</span>
<span class="go">     [22, 23]]])</span>
</pre></div>
</div>
</div>
<div class="section" id="references">
<h2><span class="section-number">3.4. </span>References</h2>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>T.G.Kolda and B.W.Bader, “Tensor Decompositions and Applications”,
SIAM REVIEW, vol. 51, n. 3, pp. 455-500, 2009.</td></tr>
</tbody>
</table>
</div>
</div>




                    <nav class="pagination">
    
    
    <a class="button is-medium pagination-previous" href="backend.html" title="2. TensorLy’s backend system" accesskey="p">
        <span class="icon">
            <i class="fa fa-arrow-circle-left"></i>
        </span>
        <span>Previous</span>
    </a>
    
    
    <a class="button is-medium pagination-next" href="tensor_decomposition.html" title="4. Tensor decomposition" accesskey="n">
        <span>Next </span>
        <span class="icon">
            <i class="fa fa-arrow-circle-right"></i>
        </span>
    </a>
    
</nav>

                </div>

                <footer class="footer">
    <div class="container has-text-centered">

        <p>
                &copy; 2016 - 2020, Jean Kossaifi.
        </p> 
    </div>
</footer>
            </div>

        </div>

        
        

        <script src="../_static/navigation.min.js"></script>
        <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-86209849-1', 'auto');
    ga('send', 'pageview');
</script>

    </body>
</html>